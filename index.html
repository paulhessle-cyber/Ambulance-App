import React, { useState, useEffect, useRef } from ‘react’;
import { Calculator, AlertCircle } from ‘lucide-react’;

export default function TimeAlertApp() {
const [time, setTime] = useState(new Date());
const [showOverdose, setShowOverdose] = useState(false);
const [tabletStrength, setTabletStrength] = useState(’’);
const [tabletsTaken, setTabletsTaken] = useState(’’);
const [patientWeight, setPatientWeight] = useState(’’);
const audioRef = useRef(null);
const hasPlayedRef = useRef(false);

useEffect(() => {
const timer = setInterval(() => {
setTime(new Date());
}, 100);
return () => clearInterval(timer);
}, []);

const getTimeColor = () => {
const minutes = time.getMinutes();
const seconds = time.getSeconds();

```
if ((minutes === 19 && seconds >= 40) || (minutes === 59 && seconds >= 40)) {
  return 'red';
}
if ((minutes === 18) || (minutes === 19 && seconds < 40) || 
    (minutes === 58) || (minutes === 59 && seconds < 40)) {
  return 'amber';
}
return 'normal';
```

};

const timeColor = getTimeColor();

useEffect(() => {
const minutes = time.getMinutes();
const seconds = time.getSeconds();

```
if ((minutes === 19 && seconds === 40) || (minutes === 59 && seconds === 40)) {
  if (!hasPlayedRef.current) {
    playAlarm();
    hasPlayedRef.current = true;
  }
} else if ((minutes === 19 && seconds === 43) || (minutes === 59 && seconds === 43)) {
  hasPlayedRef.current = false;
}
```

}, [time]);

const playAlarm = () => {
const audioContext = new (window.AudioContext || window.webkitAudioContext)();
const oscillator = audioContext.createOscillator();
const gainNode = audioContext.createGain();

```
oscillator.connect(gainNode);
gainNode.connect(audioContext.destination);

oscillator.frequency.value = 800;
oscillator.type = 'sine';

gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);

oscillator.start();
setTimeout(() => {
  oscillator.stop();
  audioContext.close();
}, 3000);
```

};

const calculateDose = () => {
const strength = parseFloat(tabletStrength);
const taken = parseFloat(tabletsTaken);
const weight = parseFloat(patientWeight);

```
if (strength && taken && weight && weight > 0) {
  const totalDose = strength * taken;
  const dosePerKg = totalDose / weight;
  return dosePerKg.toFixed(2);
}
return null;
```

};

const dose = calculateDose();

const getBackgroundGradient = () => {
if (timeColor === ‘red’) {
return ‘from-red-950 via-red-900 to-red-950’;
}
if (timeColor === ‘amber’) {
return ‘from-amber-950 via-amber-900 to-amber-950’;
}
return ‘from-slate-950 via-blue-950 to-slate-950’;
};

const getTimeTextColor = () => {
if (timeColor === ‘red’) return ‘text-red-300’;
if (timeColor === ‘amber’) return ‘text-amber-300’;
return ‘text-blue-300’;
};

if (showOverdose) {
return (
<div className="min-h-screen bg-gradient-to-br from-slate-950 via-blue-950 to-slate-950 p-8 relative overflow-hidden">
<div className="absolute inset-0 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-blue-900/20 via-transparent to-transparent"></div>

```
    <div className="max-w-2xl mx-auto relative z-10">
      <button
        onClick={() => setShowOverdose(false)}
        className="mb-6 px-6 py-3 bg-white/10 backdrop-blur-md text-white rounded-xl hover:bg-white/20 transition-all border border-white/20"
      >
        ← Back
      </button>
      
      <div className="bg-white/5 backdrop-blur-xl rounded-3xl shadow-2xl p-8 border border-white/10">
        <div className="flex items-center gap-3 mb-8">
          <Calculator className="w-8 h-8 text-blue-400" />
          <h2 className="text-3xl font-light text-white tracking-wide">Overdose Calculator</h2>
        </div>

        <div className="space-y-6">
          <div>
            <label className="block text-sm font-light text-gray-300 mb-2 tracking-wide">
              Tablet Strength (mg)
            </label>
            <input
              type="number"
              value={tabletStrength}
              onChange={(e) => setTabletStrength(e.target.value)}
              className="w-full px-4 py-3 bg-white/5 backdrop-blur-md border border-white/20 rounded-xl focus:border-blue-400 focus:outline-none text-lg text-white placeholder-gray-500"
              placeholder="Enter tablet strength"
            />
          </div>

          <div>
            <label className="block text-sm font-light text-gray-300 mb-2 tracking-wide">
              Tablets Taken
            </label>
            <input
              type="number"
              value={tabletsTaken}
              onChange={(e) => setTabletsTaken(e.target.value)}
              className="w-full px-4 py-3 bg-white/5 backdrop-blur-md border border-white/20 rounded-xl focus:border-blue-400 focus:outline-none text-lg text-white placeholder-gray-500"
              placeholder="Enter number of tablets"
            />
          </div>

          <div>
            <label className="block text-sm font-light text-gray-300 mb-2 tracking-wide">
              Patient Weight (kg)
            </label>
            <input
              type="number"
              value={patientWeight}
              onChange={(e) => setPatientWeight(e.target.value)}
              className="w-full px-4 py-3 bg-white/5 backdrop-blur-md border border-white/20 rounded-xl focus:border-blue-400 focus:outline-none text-lg text-white placeholder-gray-500"
              placeholder="Enter patient weight"
            />
          </div>

          {dose && (
            <div className="mt-8 p-6 bg-red-500/10 backdrop-blur-md rounded-2xl border border-red-500/30">
              <div className="flex items-center gap-2 mb-2">
                <AlertCircle className="w-5 h-5 text-red-400" />
                <h3 className="text-lg font-light text-red-300 tracking-wide">Result</h3>
              </div>
              <p className="text-5xl font-extralight text-red-300 tracking-wider">
                {dose} <span className="text-2xl">mg/kg</span>
              </p>
              <p className="text-sm text-red-300/70 mt-1 tracking-wide">Patient dose per Kg</p>
            </div>
          )}
        </div>
      </div>
    </div>
  </div>
);
```

}

const formattedTime = time.toLocaleTimeString(‘en-US’, {
hour12: false,
hour: ‘2-digit’,
minute: ‘2-digit’,
second: ‘2-digit’
});

const formattedDate = time.toLocaleDateString(‘en-US’, {
weekday: ‘long’,
month: ‘long’,
day: ‘numeric’
});

return (
<div className={`min-h-screen bg-gradient-to-br ${getBackgroundGradient()} relative overflow-hidden transition-all duration-1000`}>
{/* Animated flowing background effect */}
<div className="absolute inset-0 opacity-30">
<div className="absolute top-0 left-1/4 w-96 h-96 bg-blue-500 rounded-full mix-blend-multiply filter blur-3xl animate-blob"></div>
<div className="absolute top-0 right-1/4 w-96 h-96 bg-cyan-500 rounded-full mix-blend-multiply filter blur-3xl animate-blob animation-delay-2000"></div>
<div className="absolute bottom-0 left-1/3 w-96 h-96 bg-blue-600 rounded-full mix-blend-multiply filter blur-3xl animate-blob animation-delay-4000"></div>
</div>

```
  <style jsx>{`
    @keyframes blob {
      0% { transform: translate(0px, 0px) scale(1); }
      33% { transform: translate(30px, -50px) scale(1.1); }
      66% { transform: translate(-20px, 20px) scale(0.9); }
      100% { transform: translate(0px, 0px) scale(1); }
    }
    .animate-blob {
      animation: blob 7s infinite;
    }
    .animation-delay-2000 {
      animation-delay: 2s;
    }
    .animation-delay-4000 {
      animation-delay: 4s;
    }
  `}</style>

  <div className="max-w-5xl mx-auto px-8 py-16 relative z-10">
    {/* Time Display */}
    <div className="mb-16 text-center">
      <div className={`text-[16rem] font-extralight tracking-wider ${getTimeTextColor()} transition-colors duration-1000 leading-none mb-4`}>
        {formattedTime}
      </div>
      <div className="text-2xl font-light text-gray-400 tracking-widest">
        {formattedDate}
      </div>
    </div>

    {/* Buttons Grid */}
    <div className="grid grid-cols-2 md:grid-cols-4 gap-6">
      <button
        onClick={() => setShowOverdose(true)}
        className="group relative bg-gradient-to-br from-white/10 to-white/5 backdrop-blur-md border border-white/20 text-white p-8 rounded-2xl hover:from-white/15 hover:to-white/10 transition-all duration-300 font-light text-xl tracking-wide overflow-hidden shadow-[0_8px_32px_0_rgba(0,0,0,0.4)] hover:shadow-[0_12px_48px_0_rgba(0,0,0,0.6)] hover:translate-y-[-4px] active:translate-y-[2px] active:shadow-[0_4px_16px_0_rgba(0,0,0,0.4)]"
        style={{
          transform: 'translateZ(0)',
          boxShadow: 'inset 0 1px 0 rgba(255,255,255,0.1), 0 8px 32px rgba(0,0,0,0.4)'
        }}
      >
        <div className="absolute inset-0 bg-gradient-to-br from-red-500/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
        <span className="relative z-10">Overdose</span>
      </button>
      
      {[...Array(7)].map((_, i) => (
        <button
          key={i}
          className="bg-gradient-to-br from-white/5 to-white/2 backdrop-blur-md border border-white/10 text-gray-500 p-8 rounded-2xl font-light text-xl tracking-wide cursor-not-allowed shadow-[0_8px_32px_0_rgba(0,0,0,0.3)]"
          style={{
            transform: 'translateZ(0)',
            boxShadow: 'inset 0 1px 0 rgba(255,255,255,0.05), 0 8px 32px rgba(0,0,0,0.3)'
          }}
          disabled
        >
          Button {i + 2}
        </button>
      ))}
    </div>
  </div>
</div>
```

);
}
